# 初回実装要求書

## 概要

JPYCコンシェルジュのMVP（Minimum Viable Product）を実装する。デモで動作確認できる最小限の機能に絞り、段階的に機能を拡張する基盤を構築する。

## MVP機能スコープ

### Phase 1: 基盤構築（今回実装）

| 機能 | 説明 | 優先度 |
|------|------|--------|
| チャットUI | AIエージェントとの対話インターフェース | 必須 |
| ウォレット接続 | MetaMask連携、残高表示 | 必須 |
| 商品検索 | 楽天API連携、商品カード表示 | 必須 |
| 注文管理 | 管理者ダッシュボード（基本CRUD） | 必須 |

### Phase 2: ブロックチェーン連携（次回実装）

| 機能 | 説明 |
|------|------|
| DeFi連携 | secured.finance SDK連携（Deposit/Withdraw/Claim） |
| x402決済 | ガスレス送金 |

## ユーザーストーリー（MVP）

### US-MVP-001: チャットで質問する

```
ユーザーとして、
チャットで「何ができる？」と質問することで、
AIコンシェルジュが利用可能な機能を説明してほしい。
なぜなら、初めて使うときに何ができるか知りたいから。
```

### US-MVP-002: ウォレットを接続する

```
ユーザーとして、
「ウォレットを接続」ボタンを押すことで、
MetaMaskと接続してJPYC残高を確認したい。
なぜなら、運用や購入に使えるJPYCがいくらあるか知りたいから。
```

### US-MVP-003: 商品を検索する

```
ユーザーとして、
チャットで「チョコレートが欲しい」と伝えることで、
楽天市場から該当する商品を検索・表示してほしい。
なぜなら、利息で買えそうな商品を探したいから。
```

### US-MVP-004: 注文を管理する（管理者）

```
管理者として、
ダッシュボードで注文一覧を確認し、ステータスを更新したい。
なぜなら、ユーザーの注文を適切に処理する必要があるから。
```

## 受け入れ条件（MVP）

### AC-MVP-001: チャットUI

- [x] メッセージを入力・送信できる
- [x] AIからの応答が表示される
- [x] 会話履歴が画面に表示される
- [x] ローディング状態が分かる

### AC-MVP-002: ウォレット接続

- [x] MetaMask接続ボタンがある
- [x] 接続状態が表示される（アドレス短縮表示）
- [x] 切断ボタンがある
- [x] JPYC残高が表示される（モック可）

### AC-MVP-003: 商品検索

- [x] チャットで商品を検索できる
- [x] 商品カードが表示される（画像・名前・価格）
- [x] 商品詳細リンクがある

### AC-MVP-004: 管理者ダッシュボード

- [x] 管理者ログイン画面がある
- [x] 注文一覧が表示される
- [x] 注文ステータスを更新できる

## 技術的要件

### 環境セットアップ

- Next.js 15 + React 19
- TypeScript 5.x
- Tailwind CSS + shadcn/ui
- Prisma + PostgreSQL
- Vercel AI SDK（OpenAI）
- Wagmi + Viem

### データベース

- usersテーブル
- conversationsテーブル
- messagesテーブル
- ordersテーブル

### API

- POST /api/chat - チャット送受信
- GET /api/products/search - 商品検索
- GET/POST/PATCH /api/orders - 注文管理
- POST /api/admin/login - 管理者認証

## 制約事項

- 楽天APIのアプリケーションIDが必要
- OpenAI APIキーが必要
- デモ用のため、実際の決済機能は含まない
- DeFi連携・x402決済は次フェーズ

## 成功基準

- チャットでAIと対話できる
- ウォレット接続・残高表示ができる
- 商品検索結果がカード表示される
- 管理者が注文一覧を確認・更新できる
